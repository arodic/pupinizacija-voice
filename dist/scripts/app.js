!function(e,i){var t=e.querySelector("#app");t.width=window.innerWidth-12,t.height=Math.floor(t.width/2),t.scene=new i.Scene;var a=i.ImageUtils.loadTexture("images/grid.png");a.wrapS=i.RepeatWrapping,a.wrapT=i.RepeatWrapping,a.anisotropy=6;var o=i.ImageUtils.loadTexture("images/displace.jpg"),n=new i.ShaderMaterial({uniforms:{map:{type:"t",value:a},displace:{type:"t",value:o},audio:{type:"t",value:null}},vertexShader:["uniform sampler2D displace;","varying vec2 vUv;","void main() {"," vUv = uv * 50.0;"," vec4 offset = texture2D( displace, uv );"," vec4 mvPosition = modelViewMatrix * vec4( position + vec3(0.0, 0.0, 15.0 * pow(offset.r, 3.0)), 1.0 );"," gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D map;","uniform sampler2D audio;","varying vec2 vUv;","void main() {"," vec4 texelColor = texture2D( map, vUv );"," vec4 audioColor = texture2D( audio, vUv );","	gl_FragColor = vec4( texelColor.rgb + 10.0 * (audioColor.rgb - vec3(0.5)), 1.0 );","}"].join("\n")}),r=new i.Mesh(new i.PlaneBufferGeometry(150,150,50,50),n);r.rotation.x=-Math.PI/2,r.position.y=-5,t.scene.add(r),window.addEventListener("resize",function(){t.width=window.innerWidth-12,t.height=Math.floor(t.width/2)}),t.onResultChanged=function(e){this.$.animation.addAnimation(this.scene,e.detail.value)};var v=function(){n.uniforms.audio.value=t.$.voice.freqDataTexture,requestAnimationFrame(v),t.$.animation.update(),t.$.voice.update(),t.$.viewport.render()};t.addEventListener("dom-change",function(){this.$.viewport.scene=t.scene;var e=this.$.viewport.camera;e.fov=90,e.position.set(0,5,10),e.lookAt(e._target),v()})}(document,THREE),function(e,i){var t=e.querySelector("#app");t.width=window.innerWidth-12,t.height=Math.floor(t.width/2),t.scene=new i.Scene;var a=i.ImageUtils.loadTexture("images/grid.png");a.wrapS=i.RepeatWrapping,a.wrapT=i.RepeatWrapping,a.anisotropy=6;var o=i.ImageUtils.loadTexture("images/displace.jpg"),n=new i.ShaderMaterial({uniforms:{map:{type:"t",value:a},displace:{type:"t",value:o},audio:{type:"t",value:null}},vertexShader:["uniform sampler2D displace;","varying vec2 vUv;","void main() {"," vUv = uv * 50.0;"," vec4 offset = texture2D( displace, uv );"," vec4 mvPosition = modelViewMatrix * vec4( position + vec3(0.0, 0.0, 15.0 * pow(offset.r, 3.0)), 1.0 );"," gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D map;","uniform sampler2D audio;","varying vec2 vUv;","void main() {"," vec4 texelColor = texture2D( map, vUv );"," vec4 audioColor = texture2D( audio, vUv );","	gl_FragColor = vec4( texelColor.rgb + 10.0 * (audioColor.rgb - vec3(0.5)), 1.0 );","}"].join("\n")}),r=new i.Mesh(new i.PlaneBufferGeometry(150,150,50,50),n);r.rotation.x=-Math.PI/2,r.position.y=-5,t.scene.add(r),window.addEventListener("resize",function(){t.width=window.innerWidth-12,t.height=Math.floor(t.width/2)}),t.onResultChanged=function(e){this.$.animation.addAnimation(this.scene,e.detail.value)};var v=function(){n.uniforms.audio.value=t.$.voice.freqDataTexture,requestAnimationFrame(v),t.$.animation.update(),t.$.voice.update(),t.$.viewport.render()};t.addEventListener("dom-change",function(){this.$.viewport.scene=t.scene;var e=this.$.viewport.camera;e.fov=90,e.position.set(0,5,10),e.lookAt(e._target),v()})}(document,THREE);