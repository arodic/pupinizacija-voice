!function(e,i){var a=e.querySelector("#app");a.width=window.innerWidth,a.height=Math.floor(a.width/2),a.scene=new i.Scene,a.camera=new i.PerspectiveCamera(90,2,.1,1e3),a.camera.position.set(0,4,40),a.camera.lookAt(new i.Vector3);var o=i.ImageUtils.loadTexture("images/grid.png");o.wrapS=i.RepeatWrapping,o.wrapT=i.RepeatWrapping,o.anisotropy=6;var t=i.ImageUtils.loadTexture("images/displace.jpg"),r=new i.ShaderMaterial({uniforms:{map:{type:"t",value:o},displace:{type:"t",value:t},audio:{type:"t",value:null}},vertexShader:["uniform sampler2D displace;","uniform sampler2D audio;","varying vec2 vUv;","varying float dist;","void main() {"," vUv = uv;"," dist = distance(uv * vec2(1.0, 0.5), vec2(0.35, 0.05));"," float audioColor = texture2D( audio, vec2(dist, 0.0) ).r;"," float offset = texture2D( displace, uv ).r * 45.0 + audioColor * 3.0;"," vec4 mvPosition = modelViewMatrix * vec4( position + vec3(0.0, 0.0, offset), 1.0 );"," gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D map;","uniform sampler2D audio;","varying vec2 vUv;","varying float dist;","void main() {"," vec4 texelColor = 10.0 * texture2D( map, vUv * vec2(150.0, 75.0) );"," float audioColor = texture2D( audio, vec2(dist, 0.0) ).r;","	gl_FragColor = vec4( texelColor.rgb * (1.0 + 15.0 * audioColor), 1.0 );","}"].join("\n")}),n=new i.Mesh(new i.PlaneBufferGeometry(150,75,150,75),r);n.rotation.x=-Math.PI/2,n.position.y=0,a.scene.add(n);for(var d=new i.ShaderMaterial({uniforms:{audio:{type:"t",value:null}},vertexShader:["uniform sampler2D audio;","void main() {"," float offset = texture2D( audio, vec2(uv.x, 0.0) ).r * 3.;"," vec4 mvPosition = modelViewMatrix * vec4( position + vec3(0.0, offset, 0.0), 1.0 );"," gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D audio;","void main() {","	gl_FragColor = vec4( 1.0 );","}"].join("\n")}),u=2048,v=new i.BufferGeometry,l=new Float32Array(3*u),s=new Float32Array(2*u),m=0;u>m;m++){var c=-20+m/u*40,f=3.5,p=30;l[3*m]=c,l[3*m+1]=f,l[3*m+2]=p,s[2*m]=m/u,s[2*m+1]=m/u}v.addAttribute("position",new i.BufferAttribute(l,3)),v.addAttribute("uv",new i.BufferAttribute(s,2)),v.computeBoundingSphere();var w=new i.Line(v,d);a.scene.add(w),window.addEventListener("resize",function(){a.width=window.innerWidth,a.height=Math.floor(a.width/2)}),a.onResultChanged=function(e){this.$.animation.addAnimation(this.scene,e.detail.value)};var g=function(){requestAnimationFrame(g),a.$.animation.update(),a.$.voice.update(),a.$.renderer.clear(),a.$.renderer.render(a.scene,a.camera)};a.addEventListener("dom-change",function(){d.uniforms.audio.value=a.$.voice.waveHistoryTexture,r.uniforms.audio.value=a.$.voice.levelHistoryTexture,g()})}(document,THREE),function(e,i){var a=e.querySelector("#app");a.width=window.innerWidth,a.height=Math.floor(a.width/2),a.scene=new i.Scene,a.camera=new i.PerspectiveCamera(90,2,.1,1e3),a.camera.position.set(0,4,40),a.camera.lookAt(new i.Vector3);var o=i.ImageUtils.loadTexture("images/grid.png");o.wrapS=i.RepeatWrapping,o.wrapT=i.RepeatWrapping,o.anisotropy=6;var t=i.ImageUtils.loadTexture("images/displace.jpg"),r=new i.ShaderMaterial({uniforms:{map:{type:"t",value:o},displace:{type:"t",value:t},audio:{type:"t",value:null}},vertexShader:["uniform sampler2D displace;","uniform sampler2D audio;","varying vec2 vUv;","varying float dist;","void main() {"," vUv = uv;"," dist = distance(uv * vec2(1.0, 0.5), vec2(0.35, 0.05));"," float audioColor = texture2D( audio, vec2(dist, 0.0) ).r;"," float offset = texture2D( displace, uv ).r * 45.0 + audioColor * 3.0;"," vec4 mvPosition = modelViewMatrix * vec4( position + vec3(0.0, 0.0, offset), 1.0 );"," gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D map;","uniform sampler2D audio;","varying vec2 vUv;","varying float dist;","void main() {"," vec4 texelColor = 10.0 * texture2D( map, vUv * vec2(150.0, 75.0) );"," float audioColor = texture2D( audio, vec2(dist, 0.0) ).r;","	gl_FragColor = vec4( texelColor.rgb * (1.0 + 15.0 * audioColor), 1.0 );","}"].join("\n")}),n=new i.Mesh(new i.PlaneBufferGeometry(150,75,150,75),r);n.rotation.x=-Math.PI/2,n.position.y=0,a.scene.add(n);for(var d=new i.ShaderMaterial({uniforms:{audio:{type:"t",value:null}},vertexShader:["uniform sampler2D audio;","void main() {"," float offset = texture2D( audio, vec2(uv.x, 0.0) ).r * 3.;"," vec4 mvPosition = modelViewMatrix * vec4( position + vec3(0.0, offset, 0.0), 1.0 );"," gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D audio;","void main() {","	gl_FragColor = vec4( 1.0 );","}"].join("\n")}),u=2048,v=new i.BufferGeometry,l=new Float32Array(3*u),s=new Float32Array(2*u),m=0;u>m;m++){var c=-20+m/u*40,f=3.5,p=30;l[3*m]=c,l[3*m+1]=f,l[3*m+2]=p,s[2*m]=m/u,s[2*m+1]=m/u}v.addAttribute("position",new i.BufferAttribute(l,3)),v.addAttribute("uv",new i.BufferAttribute(s,2)),v.computeBoundingSphere();var w=new i.Line(v,d);a.scene.add(w),window.addEventListener("resize",function(){a.width=window.innerWidth,a.height=Math.floor(a.width/2)}),a.onResultChanged=function(e){this.$.animation.addAnimation(this.scene,e.detail.value)};var g=function(){requestAnimationFrame(g),a.$.animation.update(),a.$.voice.update(),a.$.renderer.clear(),a.$.renderer.render(a.scene,a.camera)};a.addEventListener("dom-change",function(){d.uniforms.audio.value=a.$.voice.waveHistoryTexture,r.uniforms.audio.value=a.$.voice.levelHistoryTexture,g()})}(document,THREE);