!function(e,i){var t=e.querySelector("#app");t.width=window.innerWidth-12,t.height=Math.floor(t.width/2),t.scene=new i.Scene;var a=i.ImageUtils.loadTexture("images/grid.png");a.wrapS=i.RepeatWrapping,a.wrapT=i.RepeatWrapping,a.anisotropy=6;var o=i.ImageUtils.loadTexture("images/displace.jpg"),n=new i.ShaderMaterial({uniforms:{map:{type:"t",value:a},displace:{type:"t",value:o},audio:{type:"t",value:null}},vertexShader:["uniform sampler2D displace;","uniform sampler2D audio;","varying vec2 vUv;","varying float dist;","void main() {"," vUv = uv;"," dist = distance(uv * vec2(1.0, 0.5), vec2(0.35, 0.05));"," float audioColor = texture2D( audio, vec2(dist, 0.0) ).r;"," float offset = texture2D( displace, uv ).r * 45.0 + audioColor;"," vec4 mvPosition = modelViewMatrix * vec4( position + vec3(0.0, 0.0, offset), 1.0 );"," gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D map;","uniform sampler2D audio;","varying vec2 vUv;","varying float dist;","void main() {"," vec4 texelColor = 15.0 * texture2D( map, vUv * vec2(150.0, 75.0) );"," float audioColor = texture2D( audio, vec2(dist, 0.0) ).r;","	gl_FragColor = vec4( texelColor.rgb * (1.0 + 15.0 * audioColor), 1.0 );","}"].join("\n")}),r=new i.Mesh(new i.PlaneBufferGeometry(150,75,150,75),n);r.rotation.x=-Math.PI/2,r.position.y=0,t.scene.add(r),window.addEventListener("resize",function(){t.width=window.innerWidth-12,t.height=Math.floor(t.width/2)}),t.onResultChanged=function(e){this.$.animation.addAnimation(this.scene,e.detail.value)};var d=function(){requestAnimationFrame(d),t.$.animation.update(),t.$.voice.update(),t.$.viewport.render()};t.addEventListener("dom-change",function(){this.$.viewport.scene=t.scene;var e=this.$.viewport.camera;e.fov=90,e.position.set(0,3,40),e.lookAt(e._target),n.uniforms.audio.value=t.$.voice.levelDataTexture,d()})}(document,THREE),function(e,i){var t=e.querySelector("#app");t.width=window.innerWidth-12,t.height=Math.floor(t.width/2),t.scene=new i.Scene;var a=i.ImageUtils.loadTexture("images/grid.png");a.wrapS=i.RepeatWrapping,a.wrapT=i.RepeatWrapping,a.anisotropy=6;var o=i.ImageUtils.loadTexture("images/displace.jpg"),n=new i.ShaderMaterial({uniforms:{map:{type:"t",value:a},displace:{type:"t",value:o},audio:{type:"t",value:null}},vertexShader:["uniform sampler2D displace;","uniform sampler2D audio;","varying vec2 vUv;","varying float dist;","void main() {"," vUv = uv;"," dist = distance(uv * vec2(1.0, 0.5), vec2(0.35, 0.05));"," float audioColor = texture2D( audio, vec2(dist, 0.0) ).r;"," float offset = texture2D( displace, uv ).r * 45.0 + audioColor;"," vec4 mvPosition = modelViewMatrix * vec4( position + vec3(0.0, 0.0, offset), 1.0 );"," gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D map;","uniform sampler2D audio;","varying vec2 vUv;","varying float dist;","void main() {"," vec4 texelColor = 15.0 * texture2D( map, vUv * vec2(150.0, 75.0) );"," float audioColor = texture2D( audio, vec2(dist, 0.0) ).r;","	gl_FragColor = vec4( texelColor.rgb * (1.0 + 15.0 * audioColor), 1.0 );","}"].join("\n")}),r=new i.Mesh(new i.PlaneBufferGeometry(150,75,150,75),n);r.rotation.x=-Math.PI/2,r.position.y=0,t.scene.add(r),window.addEventListener("resize",function(){t.width=window.innerWidth-12,t.height=Math.floor(t.width/2)}),t.onResultChanged=function(e){this.$.animation.addAnimation(this.scene,e.detail.value)};var d=function(){requestAnimationFrame(d),t.$.animation.update(),t.$.voice.update(),t.$.viewport.render()};t.addEventListener("dom-change",function(){this.$.viewport.scene=t.scene;var e=this.$.viewport.camera;e.fov=90,e.position.set(0,3,40),e.lookAt(e._target),n.uniforms.audio.value=t.$.voice.levelDataTexture,d()})}(document,THREE);