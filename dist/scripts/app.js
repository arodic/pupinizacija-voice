!function(e,a){var i=e.querySelector("#app");i.width=window.innerWidth,i.height=Math.floor(i.width/2),i.scene=new a.Scene,i.camera=new a.PerspectiveCamera(90,2,.1,1e3),i.camera.position.set(0,3,40),i.camera.lookAt(new a.Vector3);var t=a.ImageUtils.loadTexture("images/grid.png");t.wrapS=a.RepeatWrapping,t.wrapT=a.RepeatWrapping,t.anisotropy=6;var o=a.ImageUtils.loadTexture("images/displace.jpg"),r=new a.ShaderMaterial({uniforms:{map:{type:"t",value:t},displace:{type:"t",value:o},audio:{type:"t",value:null}},vertexShader:["uniform sampler2D displace;","uniform sampler2D audio;","varying vec2 vUv;","varying float dist;","void main() {"," vUv = uv;"," dist = distance(uv * vec2(1.0, 0.5), vec2(0.35, 0.05));"," float audioColor = texture2D( audio, vec2(dist, 0.0) ).r;"," float offset = texture2D( displace, uv ).r * 45.0 + audioColor;"," vec4 mvPosition = modelViewMatrix * vec4( position + vec3(0.0, 0.0, offset), 1.0 );"," gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D map;","uniform sampler2D audio;","varying vec2 vUv;","varying float dist;","void main() {"," vec4 texelColor = 15.0 * texture2D( map, vUv * vec2(150.0, 75.0) );"," float audioColor = texture2D( audio, vec2(dist, 0.0) ).r;","	gl_FragColor = vec4( texelColor.rgb * (1.0 + 15.0 * audioColor), 1.0 );","}"].join("\n")}),n=new a.Mesh(new a.PlaneBufferGeometry(150,75,150,75),r);n.rotation.x=-Math.PI/2,n.position.y=0,i.scene.add(n),window.addEventListener("resize",function(){i.width=window.innerWidth,i.height=Math.floor(i.width/2)}),i.onResultChanged=function(e){this.$.animation.addAnimation(this.scene,e.detail.value)};var d=function(){requestAnimationFrame(d),i.$.animation.update(),i.$.voice.update(),i.$.renderer.clear(),i.$.renderer.render(i.scene,i.camera)};i.addEventListener("dom-change",function(){r.uniforms.audio.value=i.$.voice.levelDataTexture,d()})}(document,THREE),function(e,a){var i=e.querySelector("#app");i.width=window.innerWidth,i.height=Math.floor(i.width/2),i.scene=new a.Scene,i.camera=new a.PerspectiveCamera(90,2,.1,1e3),i.camera.position.set(0,3,40),i.camera.lookAt(new a.Vector3);var t=a.ImageUtils.loadTexture("images/grid.png");t.wrapS=a.RepeatWrapping,t.wrapT=a.RepeatWrapping,t.anisotropy=6;var o=a.ImageUtils.loadTexture("images/displace.jpg"),r=new a.ShaderMaterial({uniforms:{map:{type:"t",value:t},displace:{type:"t",value:o},audio:{type:"t",value:null}},vertexShader:["uniform sampler2D displace;","uniform sampler2D audio;","varying vec2 vUv;","varying float dist;","void main() {"," vUv = uv;"," dist = distance(uv * vec2(1.0, 0.5), vec2(0.35, 0.05));"," float audioColor = texture2D( audio, vec2(dist, 0.0) ).r;"," float offset = texture2D( displace, uv ).r * 45.0 + audioColor;"," vec4 mvPosition = modelViewMatrix * vec4( position + vec3(0.0, 0.0, offset), 1.0 );"," gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D map;","uniform sampler2D audio;","varying vec2 vUv;","varying float dist;","void main() {"," vec4 texelColor = 15.0 * texture2D( map, vUv * vec2(150.0, 75.0) );"," float audioColor = texture2D( audio, vec2(dist, 0.0) ).r;","	gl_FragColor = vec4( texelColor.rgb * (1.0 + 15.0 * audioColor), 1.0 );","}"].join("\n")}),n=new a.Mesh(new a.PlaneBufferGeometry(150,75,150,75),r);n.rotation.x=-Math.PI/2,n.position.y=0,i.scene.add(n),window.addEventListener("resize",function(){i.width=window.innerWidth,i.height=Math.floor(i.width/2)}),i.onResultChanged=function(e){this.$.animation.addAnimation(this.scene,e.detail.value)};var d=function(){requestAnimationFrame(d),i.$.animation.update(),i.$.voice.update(),i.$.renderer.clear(),i.$.renderer.render(i.scene,i.camera)};i.addEventListener("dom-change",function(){r.uniforms.audio.value=i.$.voice.levelDataTexture,d()})}(document,THREE);